name: Fandom Bot 5-Minute Scheduler

# è§¦å‘å™¨ï¼šè®¾ç½®æ¯ 5 åˆ†é’Ÿè¿è¡Œä¸€æ¬¡
on:
  schedule:
    # cron è¡¨è¾¾å¼ï¼šæ¯å°æ—¶çš„ 0, 5, 10, ... 55 åˆ†é’Ÿæ‰§è¡Œ
    - cron: '*/5 * * * *' 
  # æ‰‹åŠ¨è§¦å‘ï¼šå…è®¸æ‚¨éšæ—¶ç‚¹å‡»æŒ‰é’®æµ‹è¯•è¿è¡Œ
  workflow_dispatch:

jobs:
  run_fandom_bot:
    runs-on: ubuntu-latest
    
    # ğŸŒŸ å…³é”®ï¼šå°† Secrets æ³¨å…¥ä¸ºç¯å¢ƒå˜é‡
    env:
      # Fandom è´¦å·ä¿¡æ¯ï¼Œä» Secret ä¸­å®‰å…¨è¯»å–
      FANDOM_BOT_USERNAME: 'Kerrater@Dark_Zhu_KerVs' 
      FANDOM_BOT_PASSWORD: ${{ secrets.FANDOM_BOT_PASSWORD }} 
      # Ollama å¯†é’¥ï¼Œä» Secret ä¸­å®‰å…¨è¯»å–
      OLLAMA_API_KEY: ${{ secrets.OLLAMA_API_KEY }}         
      # Ollama åŸºç¡€ API åœ°å€ (å¦‚æœéœ€è¦æ›´æ”¹æ¨¡å‹/åœ°å€ï¼Œå¯ä»¥åœ¨è¿™é‡Œè®¾ç½®)
      OLLAMA_API_BASE: "https://ollama.com/api" 
      # OLLAMA_MODEL: "kimi-k2:1t-cloud" # å¦‚æœéœ€è¦è®¾ç½®æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œè®¾ç½®

    steps:
      - name: 1. æ£€å‡ºä»£ç  (è·å–è„šæœ¬)
        uses: actions/checkout@v4

      - name: 2. è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.x' 

      - name: 3. å®‰è£…ä¾èµ– (requests)
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: 4. è¿è¡Œå•æ¬¡ä»»åŠ¡è„šæœ¬
        run: python fandom_bot_main.py
