# .github/workflows/main.yml

name: Fandom Chat Bot (Simulated User)

on:
  schedule:
    - cron: '*/5 * * * *' 
  workflow_dispatch:

jobs:
  run_bot_task:
    runs-on: ubuntu-latest
    
    steps:
      # 1. 检出代码 (必须，确保文件在工作目录中)
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2. 设置 Python 环境
      - name: Set up Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      # 3. 安装依赖 (只安装 requests 库，这是必需的)
      - name: Install requests dependency
        run: pip install requests

      # 4. 执行 Bot 主程序
      - name: Run Fandom Bot Task
        env:
          FANDOM_BOT_USERNAME: ${{ secrets.FANDOM_BOT_USERNAME }}
          FANDOM_BOT_PASSWORD: ${{ secrets.FANDOM_BOT_PASSWORD }}
          OLLAMA_API_KEY: ${{ secrets.OLLAMA_API_KEY }}
          # 仅在调试时设置 BOT_DEBUG_MODE:
          # BOT_DEBUG_MODE: ${{ secrets.BOT_DEBUG_MODE }} 
        run: python fandom_bot_main.py
